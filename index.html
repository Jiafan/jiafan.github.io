<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>技术改变生活</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="技术改变生活">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="技术改变生活">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="技术改变生活">
  
    <link rel="alternative" href="/atom.xml" title="技术改变生活" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://7xn1vb.com1.z0.glb.clouddn.com/img/avatar.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">加帆</a></h1>
		</hgroup>

		
		<p class="header-subtitle">走走停停 留一路好心情</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="#" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/EI/" style="font-size: 20px;">EI</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/Nginx/" style="font-size: 10px;">Nginx</a> <a href="/tags/OS-X/" style="font-size: 20px;">OS X</a> <a href="/tags/bi/" style="font-size: 10px;">bi</a> <a href="/tags/big-data/" style="font-size: 10px;">big data</a> <a href="/tags/cron/" style="font-size: 10px;">cron</a> <a href="/tags/logrotate/" style="font-size: 10px;">logrotate</a> <a href="/tags/server/" style="font-size: 10px;">server</a> <a href="/tags/切割/" style="font-size: 10px;">切割</a> <a href="/tags/同步/" style="font-size: 10px;">同步</a> <a href="/tags/商业智能/" style="font-size: 10px;">商业智能</a> <a href="/tags/备份/" style="font-size: 10px;">备份</a> <a href="/tags/大数据/" style="font-size: 10px;">大数据</a> <a href="/tags/客户端设计/" style="font-size: 10px;">客户端设计</a> <a href="/tags/数据采集/" style="font-size: 10px;">数据采集</a> <a href="/tags/日志/" style="font-size: 10px;">日志</a> <a href="/tags/转存/" style="font-size: 10px;">转存</a> <a href="/tags/镜像/" style="font-size: 10px;">镜像</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">奥巴马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">卡卡的美丽传说</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">本泽马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">吉格斯的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">习大大大不同</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">托蒂的博客</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">从事移动相关研发5年，3年数据相关研发经验，偏好于研究学习移动端用户体验、用户行为采集、web服务(日志接收与处理、管理后台、报表平台)等方向～摄影爱好者</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">加帆</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="http://7xn1vb.com1.z0.glb.clouddn.com/img/avatar.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">加帆</h1>
			</hgroup>
			
			<p class="header-subtitle">走走停停 留一路好心情</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="#" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-异常-OS X-EI-编译Nginx" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/09/异常-OS X-EI-编译Nginx/" class="article-date">
  	<time datetime="2016-01-09T04:01:42.000Z" itemprop="datePublished">2016-01-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/09/异常-OS X-EI-编译Nginx/">【异常】OS X 10.11( EI )上 Nginx 的 https moudle</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
      
        <h2 id="开笔"><a href="#开笔" class="headerlink" title="开笔"></a>开笔</h2><p>自 OS X 10.11 起，Apple 对 OS X 系统的安全做了全新的升级，增加了诸多限制，如 我们再也不能 <code>ln</code> 自己编译安装的软件到 <code>/usr/bin</code> 、<code>/usr/sbin</code> 了;自带的 openssl不再有 libssl-deve 的库了。</p>
<p>笔者在使用 nginx 第三方库 <code>nginx-upload-module</code>的时候无法绕开 <code>https</code>编译库。使用了 brew 安装 libssl-devel 失败、使用源码编译 openssl 也没找到办法连接或者配置lib的路径。最终选择with-openssl选项编译。</p>
<h2 id="具体问题"><a href="#具体问题" class="headerlink" title="具体问题"></a>具体问题</h2><p>在 Mac 上做过源码编译安装 openssl 开发者一定知道知道，需要手动指定64位。否则贼会出现如下警告:</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">WARNING! If you wish to build 64-bit library, then you have to<span class="built_in"></span></div><div class="line">invoke ‘./Configure darwin64-x86_64-cc’ *manually*.</div></pre></td></tr></table></figure>
<p>因此，在 openssl 的编译配置中，使用 <code>./Configure darwin64-x86_64-cc</code> ，即可顺利安装。</p>
<p>这个不难，但是，笔者在使用做 nginx 源码编译安装时，源码编译的 <code>openssl</code> （prefix 配置到 <code>/usr/local/openssl</code>） nginx 依然无法找到 ssl lib 的路径；</p>
<p>在 10.10 及其之前的 OS X 版本 prefix 不配置即可(默认 <code>/usr/local</code>)，是可以找到 ssl lib 的。但这个在 10.11 版本系统中无法使用。</p>
<h2 id="解决步骤"><a href="#解决步骤" class="headerlink" title="解决步骤"></a>解决步骤</h2><ol>
<li>使用源码编译，分别下载nginx，openssl，pcre</li>
<li><p>准备编译nginx,记住先只进行 config ，不要急着 make</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">./configure \</div><div class="line">-<span class="ruby">-prefix=<span class="regexp">/usr/local</span><span class="regexp">/nginx \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">-user=Jiafan \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">-group=staff \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">-with-http_ssl_module \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">-with-http_realip_module \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">-with-http_ssl_module \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">-with-http_realip_module \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">-with-http_addition_module \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">-with-http_sub_module \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">-with-http_dav_module \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">-with-http_flv_module \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">-with-http_gzip_static_module \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">-with-http_stub_status_module \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">-with-mail \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">-with-mail_ssl_module \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">-with-pcre=/</span>* source path to pcre *<span class="regexp">/ \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">-with-openssl=/</span>* source path to openssl *<span class="regexp">/ \</span></span></div><div class="line">-<span class="ruby"><span class="regexp">-add-module=/</span>* source path to nginx upload <span class="class"><span class="keyword">module</span> */</span></span></div></pre></td></tr></table></figure>
</li>
<li><p>如果直接编译，openssl 会报错：</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">WARNING! If you wish to build 64-bit library, then you have to<span class="built_in"></span></div><div class="line">invoke ‘./Configure darwin64-x86_64-cc’ *manually*.</div></pre></td></tr></table></figure>
</li>
</ol>
<p>如果你不停止编译就会出错。这个问题应该是 openssl/config脚本猜对你的系统是64位，但是 会根据$KERNEL_BITS来判断是否开启x86_64编译，默认 是不开启的(很奇怪的设置，虽然会给你5秒时间停止编译并手动开启)，所以你生成的openssl库文件是32位的，最后静态链接到nginx会出错。目前看来没有很好的方法把x86_64的参数传到openssl配置文件中 (openssl/config 猜测os架构，设置编译的参数是32位还是64位，默认是32位，然后调用openssl/Configure生成Makefile)</p>
<p>4.进入nginx目录，手动修改 objs/Makefile:<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">.<span class="regexp">/config –prefix=/Users/xxx/Downloads/openssl-1.0.1e/</span>.openssl <span class="literal">no</span>-shared <span class="literal">no</span>-threads</div></pre></td></tr></table></figure></p>
<p>改成<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">.<span class="regexp">/Configure darwin64-x86_64-cc –prefix=/Users/xxx/Downloads/openssl-1.0.1e/</span>.openssl <span class="literal">no</span>-shared <span class="literal">no</span>-threads</div></pre></td></tr></table></figure></p>
<h3 id="收工"><a href="#收工" class="headerlink" title="收工"></a>收工</h3><p>后面进行 make 和 make install </p>
<h2 id="PS"><a href="#PS" class="headerlink" title="PS"></a>PS</h2><p>欢迎来到我github上的空间：<a href="https://jiafan.github.io" target="_blank" rel="external">https://jiafan.github.io</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/EI/">EI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Nginx/">Nginx</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OS-X/">OS X</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/异常排除/">异常排除</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-移动端App-版本号制定与利用" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/23/移动端App-版本号制定与利用/" class="article-date">
  	<time datetime="2015-12-23T14:01:42.000Z" itemprop="datePublished">2015-12-23</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/23/移动端App-版本号制定与利用/">App版本号的制定与利用</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
      
<div id="toc" class="toc-article">
  <strong class="toc-title">文章目录</strong>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#开笔"><span class="toc-text">开笔</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#范式"><span class="toc-text">范式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#应用移动应用"><span class="toc-text">应用移动应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#iOS"><span class="toc-text">iOS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Android"><span class="toc-text">Android</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#版本意义"><span class="toc-text">版本意义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#版本设置"><span class="toc-text">版本设置</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#意义"><span class="toc-text">意义</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PS"><span class="toc-text">PS</span></a></li></ol>
</div>

        <h2 id="开笔"><a href="#开笔" class="headerlink" title="开笔"></a>开笔</h2><p>工作这几年以来，印象中 App 的版本时常被 <code>一拍脑袋</code> 就定了，以前总忍不住说几句，现在似乎逐渐习惯了。但总还是想说点什么，有些惯例或者说范式，遵循一下，还是有长久的好处的。</p>
<h2 id="范式"><a href="#范式" class="headerlink" title="范式"></a>范式</h2><p>主版本号.次版本号.修订版本号</p>
<p>范例：<code>2.0.0</code></p>
<ol>
<li>主版本号：接口做了不支持向下兼容的更改，升级主版本号；</li>
<li>次版本号：做了功能性升级，支持向下兼容，老版本依然正常使用；</li>
<li>修订号：做问题修正，通常修复缺陷</li>
</ol>
<h2 id="应用移动应用"><a href="#应用移动应用" class="headerlink" title="应用移动应用"></a>应用移动应用</h2><h3 id="iOS"><a href="#iOS" class="headerlink" title="iOS"></a>iOS</h3><p>在苹果的应用版本体系中，版本号+编译号 一同唯一标识 AppStore 中的一个特定的提交。<br><img src="https://developer.apple.com/library/ios/technotes/tn2420/Art/tn2420_image.png" alt="Xcode中的版本号"></p>
<h3 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h3><p>安卓（Android）版本号涉及到两个：<code>versionCode</code> 和 <code>versionName</code> </p>
<h4 id="版本意义"><a href="#版本意义" class="headerlink" title="版本意义"></a>版本意义</h4><ul>
<li><code>verisonCode</code> 是作为一个内部版本号，必须是整型。用来区分版本的新旧，版本号越大，代表距当前越近的发布版本。这个数字不是给用户使用的，是给开发者内部使用的</li>
<li><code>versionName</code> 是向用户战士的版本号，必须是字符串，这个版本号就是我们可以用来遵循规范的位置，可以作为版本比较的，判断是否需要提示更新、是否需要强制更新的依据。</li>
</ul>
<h4 id="版本设置"><a href="#版本设置" class="headerlink" title="版本设置"></a>版本设置</h4><p>目前两大开发IDE：Eclipse 、Android Studio 设置版本号在不同的位置。</p>
<ul>
<li>Eclipse 在 manifest 里面配置；</li>
<li>Android Studio 在 Gradle Scripts 下面的 build.gradle 配置</li>
</ul>
<p><img src="http://7xn1vb.com1.z0.glb.clouddn.com/img/android-ver.png" alt="Android Version"></p>
<h3 id="意义"><a href="#意义" class="headerlink" title="意义"></a>意义</h3><p>统一规范版本号，虽然大家沟通的时候，都是一个号码，但在做软件更新升级的时候还是方便很多的。后台版本更新接口，版本检测一套逻辑，简洁干净。</p>
<h2 id="PS"><a href="#PS" class="headerlink" title="PS"></a>PS</h2><p>欢迎来到我github上的空间：<a href="https://jiafan.github.io" target="_blank" rel="external">https://jiafan.github.io</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/客户端设计/">客户端设计</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/移动研发/">移动研发</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Big Data for BI - 数据采集常见关键字" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/26/Big Data for BI - 数据采集常见关键字/" class="article-date">
  	<time datetime="2015-11-26T05:01:34.000Z" itemprop="datePublished">2015-11-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/26/Big Data for BI - 数据采集常见关键字/">Big Data for BI - 数据采集常见关键字</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
      
<div id="toc" class="toc-article">
  <strong class="toc-title">文章目录</strong>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#UUID"><span class="toc-text">UUID</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UV"><span class="toc-text">UV</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PV"><span class="toc-text">PV</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AR"><span class="toc-text">AR</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DAU"><span class="toc-text">DAU</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CPA"><span class="toc-text">CPA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CPP"><span class="toc-text">CPP</span></a></li></ol>
</div>

        <h2 id="UUID"><a href="#UUID" class="headerlink" title="UUID"></a>UUID</h2><p>通用唯一标识符（universally unique identifier）是软件工程中使用的标识符标准。 UUID是一个简单的一个128位的值。每一位的意义由任何几个变种限定。对于人类可读显示，许多系统使用一个规范的格式使用十六进制文本插入连字符。 例如：</p>
<p><code>de305d54-75b4-431b-adb2-eb6b9e546014</code></p>
<p>在做数据采集时，遇到做设备唯一标识的时候经常遇到，目前在做 iOS、Android设备唯一标识时，获取的都是符合这一格式的标识，通常在建立表的时候，字段长度可以确定为 36个字节</p>
<h2 id="UV"><a href="#UV" class="headerlink" title="UV"></a>UV</h2><p>唯一访客(Unique visitor), 实际指标是唯一访客数(Unique visitors),统计在一定时期内访问页面、网站或者客户端的不同用户数，唯一访客长久以来都是网站用户行为的一项重要指标。</p>
<p>这个依据能采集到的数据不同，可以使用用户ID区分或者设备ID区分统计。</p>
<h2 id="PV"><a href="#PV" class="headerlink" title="PV"></a>PV</h2><p>页面访问(page view or page impression) 是互联网网站web页面的一次加载。页面访问一直以来也都是网站用户行为的一项重要指标</p>
<h2 id="AR"><a href="#AR" class="headerlink" title="AR"></a>AR</h2><p>逃出率(Abandonment Rate) ，标识用户在使用过程中各个环节中，用户离开的比例。</p>
<h2 id="DAU"><a href="#DAU" class="headerlink" title="DAU"></a>DAU</h2><p>日活跃(Daily Active Users),每日活跃用户数。</p>
<h2 id="CPA"><a href="#CPA" class="headerlink" title="CPA"></a>CPA</h2><p>每行动成本（Cost Per Action）,即广告主为每个行动所付出的成本。</p>
<p>其计算公式为：<code>CPA =总成本 总成本 /转化次数</code></p>
<h2 id="CPP"><a href="#CPP" class="headerlink" title="CPP"></a>CPP</h2><p>每交易成本(Cost per Purchase)，每次交易背后的广告成本。</p>
<p>广告主为规避广告费用风险，只有在网络用户点击旗帜广告并进行在线交易后，才按销售笔数付给广告站点费用。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bi/">bi</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/big-data/">big data</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/商业智能/">商业智能</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/大数据/">大数据</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据采集/">数据采集</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/大数据/">大数据</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-异常 - OS X-EI-目录权限" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/09/异常 - OS X-EI-目录权限/" class="article-date">
  	<time datetime="2015-10-09T15:01:42.000Z" itemprop="datePublished">2015-10-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/09/异常 - OS X-EI-目录权限/">【异常】OS X-EI-目录权限</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
      
        <h2 id="开笔"><a href="#开笔" class="headerlink" title="开笔"></a>开笔</h2><p>自 OS X 10.11 起，Apple 对 OS X 系统的安全做了全新的升级，增加了诸多限制.系统文件被做了特殊保护标记，纵然使用 <code>sudo</code> 也无法做更改。 这样以来，我们再也不能 <code>ln</code> 自己编译安装的软件到 <code>/usr/bin</code> 、<code>/usr/sbin</code> 了。还有，自带的 <code>openssl</code> 也不再有 libssl-deve 的库了。</p>
<h2 id="肇事者：SIP"><a href="#肇事者：SIP" class="headerlink" title="肇事者：SIP"></a>肇事者：SIP</h2><p>其实都是 <code>SIP</code> 搞得鬼，就是对 <code>SIP（System Integrity Protection</code> 对系统所涉及的，下面的目录列表，只能被系统本身写：</p>
<ul>
<li>/bin</li>
<li>/sbin</li>
<li>/usr</li>
<li>/System</li>
</ul>
<p>当然，Apple 也为开发者开放了如下目录：</p>
<ul>
<li>/usr/local</li>
<li>/Applications</li>
<li>[~]/Library</li>
</ul>
<p>可以看得出来， <code>/usr</code> 目录下，除了 <code>/usr/local</code> 之外目录，都被限制保护了。</p>
<h2 id="解决步骤"><a href="#解决步骤" class="headerlink" title="解决步骤"></a>解决步骤</h2><ol>
<li><p>进入恢复模式<br> <img src="http://7xn1vb.com1.z0.glb.clouddn.com/img/kb.jpg" alt="进入恢复模式"></p>
</li>
<li><p>工具箱<br> <img src="http://7xn1vb.com1.z0.glb.clouddn.com/img/utilities.jpg" alt="工具箱"></p>
</li>
<li><p>打开控制台<br> <img src="http://7xn1vb.com1.z0.glb.clouddn.com/img/terminal.jpg" alt="控制台"></p>
</li>
<li><p>在控制台执行命令 </p>
<p> <code>csrutil disable</code></p>
<p> 回车</p>
</li>
<li>重启电脑</li>
<li><p>在做了相应的更改之后，建议再如上进入恢复模式，命令行开启 <code>csrutil</code> </p>
<p> <code>csrutil enable</code></p>
</li>
</ol>
<h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><p><a href="https://developer.apple.com/library/mac/documentation/Security/Conceptual/System_Integrity_Protection_Guide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40016462-CH1-DontLinkElementID_15" target="_blank" rel="external">Apple System Integrity Protection Guid</a></p>
<p><a href="https://developer.apple.com/library/mac/documentation/Security/Conceptual/System_Integrity_Protection_Guide/ConfiguringSystemIntegrityProtection/ConfiguringSystemIntegrityProtection.html#//apple_ref/doc/uid/TP40016462-CH5-SW1" target="_blank" rel="external">Apple 关于如何开关 SIP</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/EI/">EI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OS-X/">OS X</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/异常排除/">异常排除</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-数据同步 - rsync" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/03/数据同步 - rsync/" class="article-date">
  	<time datetime="2015-10-02T18:13:21.000Z" itemprop="datePublished">2015-10-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/03/数据同步 - rsync/">数据同步 - rsync</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
      
<div id="toc" class="toc-article">
  <strong class="toc-title">文章目录</strong>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#开笔"><span class="toc-text">开笔</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#背景（废话）"><span class="toc-text">背景（废话）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#概述"><span class="toc-text">概述</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装"><span class="toc-text">安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用"><span class="toc-text">使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#基本语法"><span class="toc-text">基本语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#本地拷贝"><span class="toc-text">本地拷贝</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#远程拷贝"><span class="toc-text">远程拷贝</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用ssh"><span class="toc-text">使用ssh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他高级选项"><span class="toc-text">其他高级选项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#优势和特点（可看可不看）"><span class="toc-text">优势和特点（可看可不看）</span></a></li></ol>
</div>

        <h2 id="开笔"><a href="#开笔" class="headerlink" title="开笔"></a>开笔</h2><h3 id="背景（废话）"><a href="#背景（废话）" class="headerlink" title="背景（废话）"></a>背景（废话）</h3><p>做接口服务端，基本上都会使用负载均衡来保证后台的可用性，做负载均衡有很多方法，有硬负载，也有软负载，但负载均衡的后面，就是我们的应用服务，一般都是几台硬件配置相似的，应用服务完全相同的机器。当我们要为这几台机器部署完全相同的应用服务，并维护和更新这几台机器上的应用服务，自然就遇到最直接的数据（包括服务）同步的问题，笔者就是遇到这个问题，才想办法，研究怎么优雅的解决这个问题。</p>
<p>当然，数据同步的场景包含笔者所描述的，但不仅限于此。</p>
<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>rsync 是一款快速并多样的异地文件拷贝工具。具备通过远程脚本或者远程rsync进程来实现本地和远程主机间拷贝的能力。提供丰富的控制选项和灵活多样拷贝的权限控制,因增量拷贝闻名，广泛地用于 备份和镜像，以及作为升级版本的拷贝命令使用。rsync 一个命令行工具，若要用它，首先得对命令行有一定的了解。</p>
<p>总而言之：rsync 是一款 高效的、通用的拷贝、备份、同步数据（文件或者文件夹）工具，可以是本地的、远程的，夸目录、夸磁盘亦或是夸机器，他的高效来自于能够做到增量同步。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>在部分 Linux 发行版本中，rsync 是默认已经安装的，为确认是否已经安装，可以查看机器中是否已经安装这几个软件：</p>
<ul>
<li>rsync</li>
<li>xinetd</li>
<li>ssh</li>
</ul>
<p>没有的话请自行安装（yum 或者 apt-get 等等）.</p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><h3 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rsync <span class="keyword">options</span> <span class="keyword">source</span> destination</div></pre></td></tr></table></figure>
<p>具体有那些选项的话，我们不妨执行<code>man rsync</code>看看。</p>
<h3 id="本地拷贝"><a href="#本地拷贝" class="headerlink" title="本地拷贝"></a>本地拷贝</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rsync -z ~<span class="regexp">/test.txt /</span>Data<span class="regexp">/backup/</span></div></pre></td></tr></table></figure>
<p><img src="http://7xn1vb.com1.z0.glb.clouddn.com/img/rsync-local.png" alt="rsync-local"></p>
<h3 id="远程拷贝"><a href="#远程拷贝" class="headerlink" title="远程拷贝"></a>远程拷贝</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rsync -zvz route root<span class="meta">@jiafan</span>.<span class="string">net:</span><span class="regexp">/backup/</span></div></pre></td></tr></table></figure>
<p><img src="http://7xn1vb.com1.z0.glb.clouddn.com/img/rsync-remote.png" alt="rsync-remote"></p>
<h3 id="使用ssh"><a href="#使用ssh" class="headerlink" title="使用ssh"></a>使用ssh</h3><p><img src="http://7xn1vb.com1.z0.glb.clouddn.com/img/rsync-remote-ssh.png" alt="rsync-remote-ssh"></p>
<h3 id="其他高级选项"><a href="#其他高级选项" class="headerlink" title="其他高级选项"></a>其他高级选项</h3><h2 id="优势和特点（可看可不看）"><a href="#优势和特点（可看可不看）" class="headerlink" title="优势和特点（可看可不看）"></a>优势和特点（可看可不看）</h2><ul>
<li>高效的远程拷贝和同步文件的工具</li>
<li>支持 拷贝链接、设备、所有权、所属组和权限</li>
<li>比scp更快：基于 远程更新协议（remote-update protocol）,从而具备增量拷贝技能</li>
<li>低带宽消耗：传输前压缩，传输后解压</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/同步/">同步</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/备份/">备份</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/镜像/">镜像</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/大数据/">大数据</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-日志管理-Logrotate-日志切割和转存" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/01/日志管理-Logrotate-日志切割和转存/" class="article-date">
  	<time datetime="2015-10-01T10:59:32.000Z" itemprop="datePublished">2015-10-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/01/日志管理-Logrotate-日志切割和转存/">日志管理- Logrotate 日志切割和转存</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
      
<div id="toc" class="toc-article">
  <strong class="toc-title">文章目录</strong>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#开笔"><span class="toc-text">开笔</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#背景-废话"><span class="toc-text">背景(废话)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#基础知识"><span class="toc-text">基础知识</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#logrotate-是如何工作的"><span class="toc-text">logrotate 是如何工作的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#配置"><span class="toc-text">配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#系统配置"><span class="toc-text">系统配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用配置"><span class="toc-text">应用配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考文档"><span class="toc-text">参考文档</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ps"><span class="toc-text">ps</span></a></li></ol>
</div>

        <h2 id="开笔"><a href="#开笔" class="headerlink" title="开笔"></a>开笔</h2><h3 id="背景-废话"><a href="#背景-废话" class="headerlink" title="背景(废话)"></a>背景(废话)</h3><p>最近在做与数据相关的东西，需要处理大量日志文件。服务器日志的重要性，这里不需要赘述，nginx日志就是其中一种必须处理的。nginx的日志文件理论上是成线性持续增长的，那我们要处理这写数据，又该如何做，经过调研，笔者找到了 Linux 系统提供的服务 logrotate 。</p>
<p>logrotate 就是为管理会生成大量日志的系统而设计诞生的。它具备 自动轮转、压缩、搬迁 和 邮件通知到日志系统的多想功能。每一个日志文件都可以按照 每天、每周、每月周期性处理，亦或是 增长到多大而触发处理。</p>
<h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h3><p>日志轮转指的是实现对当前日志归档，开始新的日志，删除早期的日志。而日志，通常是应用程序记录的一些对系统管理员或者程序开发者有用的信息的文件，诸如正在执行什么、发生了什么错误等一系列信息。</p>
<p>当我们需要跟踪应用的使用过程或是解决应用的异常，日志便是最理想的工具。不幸的是日志记录越多的信息，就意味着需要越多的硬盘空间，随着时间推移，硬盘总有一天被耗光。日志如果不做轮转，就会无收敛地疯涨下去，长此下去，必然会导致多方面拖累系统运行。</p>
<h2 id="logrotate-是如何工作的"><a href="#logrotate-是如何工作的" class="headerlink" title="logrotate 是如何工作的"></a>logrotate 是如何工作的</h2><p>通常，logrotate 是作为 corn 的一个每日任务，周期性执行的.在大部分的 Linux 发布版本系统里 （Centos 、Ubuntu、Fedora），我们都能找到 </p>
<pre><code>/etc/cron.daily/logrotate
</code></pre><p>如果您需要调整 logrotate 执行的频率，可以到 cron 配置中调整。如果有需要也可以看看 我关于 cron 的一篇文章。</p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="系统配置"><a href="#系统配置" class="headerlink" title="系统配置"></a>系统配置</h3><p>在目录 /etc 中可以看到关于 logrotate 的配置文件和对应目录，你也可以自己查看一些：</p>
<pre><code>ls -al|grep logrotate
</code></pre><p>应该会发现 <code>/etc/logrotate.conf</code> 这个主配置文件，还有 <code>/etc/lograte.d</code> 这个目录。在这个目录里也许可以找到针对一个应用级别的logrotate配置，这取决于你安装了那些服务和安装方式。一般，通过包管理工具安装的应用服务，会同时创建配置文件到 <code>/etc/logrotate.d</code>目录。<br>基本上，在这个目录都会看到一个 syslog 服务的配置文件，它是用于 logrotate 轮转系统日志的配置。</p>
<h3 id="应用配置"><a href="#应用配置" class="headerlink" title="应用配置"></a>应用配置</h3><p>针对每一个应用服务，都可以有自己的日志轮转配置.笔者以一个web服务器的access日志作为例子：</p>
<ol>
<li>nginx 安装在 <code>/usr/local/nginx</code> 目录</li>
<li>nginx 配置了 access_log 到 <code>/var/log/nginx/access.log</code></li>
<li>轮转需要求：按小时轮转 access 日志。</li>
</ol>
<p>我们为这个需求创建一个配置文件：<code>/etc/logrotate.d/nginx-access.conf</code>文件内容如下：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">/<span class="keyword">var</span>/<span class="keyword">log</span>/nginx/access.<span class="keyword">log</span> &#123;</div><div class="line">	size 2M</div><div class="line">	create 777 www web</div><div class="line">	<span class="keyword">rotate</span> 65535</div><div class="line">	copytruncate</div><div class="line">	<span class="keyword">compress</span></div><div class="line">	nomail</div><div class="line">	olddir /<span class="keyword">var</span>/<span class="keyword">log</span>/nginx/old-logs/</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>紧接着，在cron服务中配置为每小时执行就实现了，如此简单，若有cron配置不清楚的地方，可以查看笔者关于 cron 的另一篇分享。</p>
<ol>
<li>crontab -e</li>
<li>01 <em> </em> <em> </em> logrotate -f /etc/logrotate.d/nginx-access.conf</li>
<li>crond restart</li>
</ol>
<p>至此，您就已经可以利用logrotate 来便捷的管理nginx服务器的日志了。在此基础上，您可以根据自己的具体需要，管理任何日志文件。更具体和详细的帮助可以使用：</p>
<pre><code>man logrotate
</code></pre><p>命令查看。</p>
<h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><p><a href="https://www.centos.org/forums/viewtopic.php?f=13&amp;t=42923" target="_blank" rel="external">centos-logroate-cron</a></p>
<h2 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h2><p>偶然发现 <a href="https://github.com/logrotate/logrotate" target="_blank" rel="external">logrotate-github(点这里)</a> 居然被放到github上了</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/logrotate/">logrotate</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/切割/">切割</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/日志/">日志</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/转存/">转存</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/大数据/">大数据</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-计划任务 - Cron(Linux)" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/01/计划任务 - Cron(Linux)/" class="article-date">
  	<time datetime="2015-10-01T06:34:13.000Z" itemprop="datePublished">2015-10-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/01/计划任务 - Cron(Linux)/">Linux 定时任务</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
      
<div id="toc" class="toc-article">
  <strong class="toc-title">文章目录</strong>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#开笔"><span class="toc-text">开笔</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cron服务查看"><span class="toc-text">cron服务查看</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cron服务管理"><span class="toc-text">cron服务管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#配置-corn-服务权限"><span class="toc-text">配置 corn 服务权限</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#编辑cron任务"><span class="toc-text">编辑cron任务</span></a></li></ol>
</div>

        <h2 id="开笔"><a href="#开笔" class="headerlink" title="开笔"></a>开笔</h2><p>最近在做数据收集涉及到一些日志文件轮转切割，笔者想用一个定时任务来实现定时轮转。调研后决定使用 Linux 系统的 cron 服务。</p>
<p><a href="https://en.wikipedia.org/wiki/Cron" target="_blank" rel="external">Cron</a> 是Uninx系（Linux） 操作系统的后台驻留程序，系统管理员用得相对多一些。Cron 可以被设置为开机启动，在 centos 中默认就是开机启动的服务。</p>
<p>在使用 cron 服务的时候，往往我们都需要 先确认cron服务本身是否开启，处于运行状态，确认当前用户是否有权限正常使用cron，编辑下发cron计划任务，确认我们的计划任务是否如约按照计划执行。本篇笔者就和大家一起看看：</p>
<ol>
<li>查看当前系统cron服务状态</li>
<li>管理 cron 服务</li>
<li>配置 corn 服务权限</li>
<li>编辑下发 cron 计划任务</li>
<li>查看 任务是否按照计划执行</li>
</ol>
<h2 id="cron服务查看"><a href="#cron服务查看" class="headerlink" title="cron服务查看"></a>cron服务查看</h2><p>除了可以用 ps 命令查看 cron 服务进程运行状态，还可以查看正在运行的cron服务调度本身的状态。通过 crontab 命令对cron服务的设置。用：</p>
<pre><code>man crontab
</code></pre><p>查看一下crontab命令，发现，crontab 有4个可选参数：</p>
<ul>
<li>-u:设定某个用户的cron服务，一般root用户在执行这个命令的时候需要此参数</li>
<li>-l:列出某个用户cron服务的详细内容</li>
<li>-r:删除某个用户的cron服务</li>
<li>-e:编辑某个用户的cron服务</li>
</ul>
<h2 id="cron服务管理"><a href="#cron服务管理" class="headerlink" title="cron服务管理"></a>cron服务管理</h2><p>如果经过查看，我们发现cron并不是你要的状态，那么就开始管理它吧。作为后台服务，cron有着与我们熟知的服务程序相似地基本管理命令：启动、停止、重启、重新载入配置(需要稍微注意一点，这里是crond 而不是 cron)：</p>
<ul>
<li><p>启动服务: </p>
  <figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta-keyword">/sbin/</span>service crond star</div></pre></td></tr></table></figure>
</li>
<li><p>关闭服务 </p>
  <figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/sbin/service crond <span class="built_in">stop</span></div></pre></td></tr></table></figure>
</li>
<li><p>重启服务</p>
  <figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta-keyword">/sbin/</span>service crond restart</div></pre></td></tr></table></figure>
</li>
<li><p>重新载入配置</p>
<p>  在每一次重新修改过cron配置文件，请务必重新载入一下配置：</p>
  <figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta-keyword">/sbin/</span>service crond reload</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="配置-corn-服务权限"><a href="#配置-corn-服务权限" class="headerlink" title="配置 corn 服务权限"></a>配置 corn 服务权限</h2><p>在 Linux 操作系统中，对用户使用cron服务的权限控制在 /etc/cron.allow 和 /etc/cron.deny 两个文件中配置实现，但 /etc/cron.allow 文件非必须存在的。</p>
<p>如果 /etc/cron.allow 文件存在，则所有需要运行 crontab 命令的用户必须在这个文件被列举出来；如果 /etc/cron.allow 文件不存在，但<br>/etc/cron.deny 文件存在，则所有需要运行 crontab 命令的用户必须在这个文件不被列举出来。当这两个文件都不存在的情况下，在一些 Linux 系统（如 Ubuntu、Debian ，但不是所有）允许所有用户运行 crontab 命令。</p>
<p>需要注意的是，系统中，不在 /etc/shadow 文件所列的用户，是没有权限使用 crontab 命令。</p>
<h2 id="编辑cron任务"><a href="#编辑cron任务" class="headerlink" title="编辑cron任务"></a>编辑cron任务</h2><ol>
<li><p>语法</p>
 <figure class="highlight gherkin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">*</span> <span class="symbol">*</span> <span class="symbol">*</span> <span class="symbol">*</span> <span class="symbol">*</span>  Command_to_execute</div><div class="line">- – – – -</div><div class="line">|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|</div><div class="line">|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> +—– Day of week (0–6) (Sunday=0) or Sun, Mon, Tue,…</span></div><div class="line">|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> +———- Month (1–12) or Jan, Feb,…</span></div><div class="line">|<span class="string"> </span>|<span class="string"> +————-— Day of month (1–31)</span></div><div class="line">|<span class="string"> +——————– Hour (0–23)</span></div><div class="line">+————————- Minute (0–59)</div></pre></td></tr></table></figure>
</li>
<li><p>示例</p>
<p> 每天凌晨轮转nginx的access日志</p>
 <figure class="highlight basic"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">01 </span><span class="number">00</span> * * * /<span class="keyword">usr</span>/sbin/logrotate /etc/logrotate.d/nginx-access-<span class="keyword">log</span>.conf</div></pre></td></tr></table></figure>
<p> 系统便会在每天凌晨壹分的时刻执行 <code>/usr/sbin/logrotate /etc/logrotate.d/nginx-access-log.conf</code> 命令，实际就是每天凌晨进行日志轮转</p>
</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cron/">cron</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/server/">server</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/运维/">运维</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 加帆
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>